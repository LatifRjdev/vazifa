import{w as x}from"./with-props-DyG_vBPJ.js";import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{u as p}from"./useQuery-CkwzADaB.js";import{q as u}from"./chunk-D4RADZKF-By21buN-.js";import{B as a}from"./badge-BR4L36Rg.js";import{C as n,d as i,a as h,b as g}from"./card-DunmZ-Mm.js";import{f}from"./fetch-utils-CEdl9sdl.js";import{u as j}from"./auth-context-B5vrc64i.js";import{a as b,f as y}from"./date-utils-BYRQ6yq9.js";import{S as l}from"./star-Cq7vPmKH.js";import{c as N}from"./createLucideIcon-DYOGCEiU.js";import{U as o}from"./user-DIG-VwFC.js";import{C as w}from"./calendar-Dcbq6X4X.js";import{C as v}from"./clock-DtXE6-Nx.js";import"./differenceInCalendarDays-D7TXt3rl.js";import"./utils-DIzSUSji.js";import"./index-CNgNZYQm.js";import"./index-CnVBUu3y.js";import"./index-DgMzxt3E.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],D=N("triangle-alert",C),J=x(function(){const{user:s}=j(),{data:t,isLoading:m}=p({queryKey:["important-tasks"],queryFn:async()=>(await f("/tasks/important/")).importantTasks,enabled:!!s&&s.role==="super_admin"});if(!s||s.role!=="super_admin")return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"У вас нет доступа к этой странице. Только супер админы могут просматривать важные задачи."})});if(m)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const d=r=>{switch(r){case"High":return"bg-red-100 text-red-800 border-red-200";case"Medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},c=r=>{switch(r){case"Done":return"bg-green-100 text-green-800 border-green-200";case"In Progress":return"bg-blue-100 text-blue-800 border-blue-200";case"Review":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(l,{className:"h-8 w-8 text-yellow-500 fill-current"}),"Важные задачи"]}),e.jsx("p",{className:"text-muted-foreground",children:"Задачи, отмеченные администраторами как важные"})]})}),!t||t.length===0?e.jsx(n,{children:e.jsxs(i,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(D,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Нет важных задач"}),e.jsx("p",{className:"text-muted-foreground text-center",children:"Пока нет задач, отмеченных как важные"})]})}):e.jsx("div",{className:"grid gap-4",children:t.map(r=>e.jsxs(n,{className:"hover:shadow-md transition-shadow border-l-4 border-l-yellow-500",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs(g,{className:"text-lg flex items-center gap-2",children:[e.jsx(l,{className:"h-5 w-5 text-yellow-500 fill-current"}),e.jsx(u,{to:`/dashboard/task/${r._id}`,className:"hover:text-primary transition-colors",children:r.title})]}),r.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:r.description}),r.markedImportantBy&&r.markedImportantAt&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Отмечено как важное"," ",typeof r.markedImportantBy=="object"?r.markedImportantBy.name:"администратором"," ",new Date(r.markedImportantAt).toLocaleDateString("ru-RU")]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(a,{variant:"outline",className:d(r.priority),children:r.priority==="High"?"Высокий":r.priority==="Medium"?"Средний":"Низкий"}),e.jsx(a,{variant:"outline",className:c(r.status),children:r.status==="To Do"?"К выполнению":r.status==="In Progress"?"В процессе":r.status==="Review"?"На проверке":"Выполнено"})]})]})}),e.jsx(i,{className:"pt-0",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[r.assignees&&r.assignees.length>0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{children:r.assignees.length===1?r.assignees[0].name:`${r.assignees.length} исполнителей`})]}),r.responsibleManager&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsxs("span",{children:["Менеджер:"," ",typeof r.responsibleManager=="object"?r.responsibleManager.name:"Не указан"]})]}),r.dueDate&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx("span",{children:b(r.dueDate)})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"h-4 w-4"}),e.jsx("span",{children:y(r.createdAt)})]})]})})]},r._id))})]})});export{J as default};
