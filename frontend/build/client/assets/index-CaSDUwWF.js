import{w as c}from"./with-props-DyG_vBPJ.js";import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{L as m}from"./loader-B2rr_xqw.js";import{u as x}from"./auth-context-B5vrc64i.js";import{u as g}from"./language-context-DQqIPPDP.js";import{a as u}from"./use-task-ClqRGOoq.js";import{u as h}from"./useQuery-CkwzADaB.js";import{f}from"./fetch-utils-CEdl9sdl.js";import{f as p}from"./date-utils-BYRQ6yq9.js";import"./chunk-D4RADZKF-By21buN-.js";import"./index-CNgNZYQm.js";import"./index-CnVBUu3y.js";import"./index-DgMzxt3E.js";import"./differenceInCalendarDays-D7TXt3rl.js";import"./useMutation-CUJSGQ7R.js";function H({}){return[{title:"Vazifa | Панель управления"},{name:"description",content:"Панель управления Vazifa!"}]}const b=()=>{const{user:a}=x(),{t}=g(),{data:i,isPending:n}=u(),{data:d,isPending:l}=h({queryKey:["all-tasks-dashboard"],queryFn:()=>f("/tasks/all-tasks"),enabled:(a==null?void 0:a.role)&&["admin","manager"].includes(a.role)}),o=(a==null?void 0:a.role)&&["admin","manager"].includes(a.role);if(o?l:n)return e.jsx(m,{message:t("common.loading_data")});let r=[];return o?r=Array.isArray(d)?d:d&&d.tasks&&Array.isArray(d.tasks)?d.tasks:[]:r=Array.isArray(i)?i:[],e.jsxs("div",{className:"space-y-8 2xl:space-y-12",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-3xl font-bold",children:t("nav.dashboard")})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[e.jsx("div",{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx("h3",{className:"tracking-tight text-sm font-medium",children:t("dashboard.total_tasks")})}),e.jsx("div",{className:"text-2xl font-bold",children:r.length})]}),e.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[e.jsx("div",{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx("h3",{className:"tracking-tight text-sm font-medium",children:t("dashboard.in_progress")})}),e.jsx("div",{className:"text-2xl font-bold",children:r.filter(s=>s.status==="In Progress").length})]}),e.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[e.jsx("div",{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx("h3",{className:"tracking-tight text-sm font-medium",children:t("dashboard.completed")})}),e.jsx("div",{className:"text-2xl font-bold",children:r.filter(s=>s.status==="Done").length})]}),e.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[e.jsx("div",{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx("h3",{className:"tracking-tight text-sm font-medium",children:t("dashboard.overdue")})}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:r.filter(s=>s.dueDate&&new Date(s.dueDate)<new Date&&s.status!=="Done").length})]})]}),e.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:t("dashboard.recent_tasks")}),r&&r.length>0?e.jsx("div",{className:"space-y-3",children:r.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t("common.created"),": ",p(s.createdAt)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Done"?"bg-green-100 text-green-800":s.status==="In Progress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.status==="Done"?t("status.done"):s.status==="In Progress"?t("status.in_progress"):s.status==="To Do"?t("status.todo"):s.status}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.priority==="High"?"bg-red-100 text-red-800":s.priority==="Medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:s.priority==="High"?t("priority.high"):s.priority==="Medium"?t("priority.medium"):t("priority.low")})]})]},s._id))}):e.jsx("p",{className:"text-muted-foreground",children:t("tasks.no_tasks_yet")})]})})]})},Q=c(b);export{Q as default,H as meta};
