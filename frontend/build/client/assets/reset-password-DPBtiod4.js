import{w as v}from"./with-props-DyG_vBPJ.js";import{j as s}from"./jsx-runtime-D_zvdyIk.js";import{t as S,a as h,q as o}from"./chunk-D4RADZKF-By21buN-.js";import{u as k,s as R,F as A,a as u,b as f,c as j,d as w,e as g}from"./form-BmyV6FyK.js";import{B as N}from"./button-CYnDp3Q-.js";import{C as I,a as L,d as E,e as H}from"./card-DunmZ-Mm.js";import{I as b}from"./input-BPm_T_uW.js";import{A as B,a as M}from"./alert-DlLWaqXv.js";import"./fetch-utils-CEdl9sdl.js";import{r as T}from"./schema-vgN0g95I.js";import{e as q}from"./use-auth-BFmN1zjT.js";import{A as z}from"./arrow-left-BZk8-X3l.js";import{C as D}from"./circle-check-c3MMHh6m.js";import{C as V}from"./circle-alert-CzTjZiAb.js";import{L as G}from"./loader-circle-DPdm6C66.js";import"./utils-DIzSUSji.js";import"./label-URIJR8-n.js";import"./index-DTIwNWd2.js";import"./index-CnVBUu3y.js";import"./useMutation-CUJSGQ7R.js";import"./index-CNgNZYQm.js";import"./createLucideIcon-DYOGCEiU.js";function xs({}){return[{title:"TaskHub | Reset Password"},{name:"description",content:"Reset Password to TaskHub!"}]}const J=()=>{const[P]=S(),n=P.get("tk"),[i,a]=h.useState(null),[C,l]=h.useState(!1),{mutate:y,isPending:m}=q(),t=k({resolver:R(T),defaultValues:{password:"",confirmPassword:""}}),F=async r=>{var c,d;a(null),l(!1);try{if(!n){a("Invalid or missing token.");return}y({token:n,newPassword:r.password,confirmPassword:r.confirmPassword},{onSuccess:()=>{l(!0),t.reset()},onError:e=>{var x,p;a(((p=(x=e==null?void 0:e.response)==null?void 0:x.data)==null?void 0:p.message)||e.message||"Failed to reset password"),console.log(e)}})}catch(e){a(((d=(c=e==null?void 0:e.response)==null?void 0:c.data)==null?void 0:d.message)||e.message||"Failed to reset password")}};return s.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-muted/40 p-4",children:s.jsxs("div",{className:"w-full max-w-md space-y-6",children:[s.jsxs("div",{className:"flex flex-col items-center space-y-2 text-center",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Сбросить пароль"}),s.jsx("p",{className:"text-muted-foreground",children:"Введите новый пароль ниже."})]}),s.jsxs(I,{className:"border-border/50 shadow-xl",children:[s.jsx(L,{children:s.jsxs(o,{to:"/sign-in",className:"flex items-center text-sm text-muted-foreground hover:text-foreground",children:[s.jsx(z,{className:"mr-2 h-4 w-4"}),"Вернуться к входу"]})}),s.jsx(E,{children:C?s.jsxs("div",{className:"flex flex-col items-center space-y-4 py-6",children:[s.jsx("div",{className:"rounded-full bg-primary/10 p-3",children:s.jsx(D,{className:"h-8 w-8 text-primary"})}),s.jsx("h3",{className:"text-xl font-semibold",children:"Сброс пароля успешен"}),s.jsx("p",{className:"text-center text-muted-foreground",children:"Ваш пароль сброшен. Теперь вы можете войти, используя новый пароль."}),s.jsx(N,{asChild:!0,className:"mt-4",children:s.jsx(o,{to:"/sign-in",children:"Перейти к входу"})})]}):s.jsx(A,{...t,children:s.jsxs("form",{onSubmit:t.handleSubmit(F),className:"space-y-4",children:[i&&s.jsxs(B,{variant:"destructive",children:[s.jsx(V,{className:"h-4 w-4"}),s.jsx(M,{children:i})]}),s.jsx(u,{control:t.control,name:"password",render:({field:r})=>s.jsxs(f,{children:[s.jsx(j,{children:"Новый пароль"}),s.jsx(w,{children:s.jsx(b,{type:"password",placeholder:"••••••••",...r})}),s.jsx(g,{})]})}),s.jsx(u,{control:t.control,name:"confirmPassword",render:({field:r})=>s.jsxs(f,{children:[s.jsx(j,{children:"Подтвердите новый пароль"}),s.jsx(w,{children:s.jsx(b,{type:"password",placeholder:"••••••••",...r})}),s.jsx(g,{})]})}),s.jsx(N,{type:"submit",size:"lg",className:"w-full",disabled:m,children:m?s.jsxs(s.Fragment,{children:[s.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Переустановка..."]}):"Reset Password"})]})})}),s.jsx(H,{children:s.jsxs("div",{className:"text-center text-sm w-full",children:["Забыли пароль?"," ",s.jsx(o,{to:"/sign-in",className:"text-blue-600 font-semibold hover:underline",children:"Войти"})]})})]})]})})},ps=v(J);export{ps as default,xs as meta};
