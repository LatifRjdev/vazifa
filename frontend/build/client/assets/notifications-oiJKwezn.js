import{w as g}from"./with-props-DyG_vBPJ.js";import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{t as i}from"./index-CNgNZYQm.js";import{L as N}from"./loader-B2rr_xqw.js";import{u as v,a as k,b as A,B as b}from"./use-user-TsMmcXVD.js";import{A as w,a as M,b as R}from"./avatar-B8lmOvvi.js";import{B as y}from"./badge-BR4L36Rg.js";import{B as n}from"./button-CYnDp3Q-.js";import{S as B}from"./scroll-area-N5jEjwpk.js";import{f as C}from"./formatDistanceToNow-DfO8AiA2.js";import"./chunk-D4RADZKF-By21buN-.js";import"./index-CnVBUu3y.js";import"./useQuery-CkwzADaB.js";import"./fetch-utils-CEdl9sdl.js";import"./differenceInCalendarDays-D7TXt3rl.js";import"./useMutation-CUJSGQ7R.js";import"./auth-context-B5vrc64i.js";import"./index-DgMzxt3E.js";import"./index-wu72o1Zw.js";import"./index-DTIwNWd2.js";import"./utils-DIzSUSji.js";import"./index-Dspms17g.js";import"./index-BhFca_hj.js";import"./index-BdQq_4o_.js";import"./en-US-DuGUIuVI.js";import"./endOfMonth-B9jd4p3w.js";function re({}){return[{title:"TaskHub | Notifications"},{name:"description",content:"Notifications to TaskHub!"}]}const D=()=>{const{data:m,isLoading:x}=v(),{mutate:p,isPending:h}=k(),{mutate:d,isPending:u}=A(),j=()=>{p(void 0,{onSuccess:()=>{i.success("All notifications marked as read")},onError:s=>{var t,a;const r=((a=(t=s.response)==null?void 0:t.data)==null?void 0:a.message)||"An error occurred";i.error(r),console.error(s)}})},f=s=>{d(s,{onSuccess:()=>{i.success("Notification marked as read")},onError:r=>{var a,l;const t=((l=(a=r.response)==null?void 0:a.data)==null?void 0:l.message)||"An error occurred";i.error(t),console.error(r)}})};if(x)return e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx(N,{message:"Загрузка уведомлений..."})});const{notifications:c,unreadCount:o}=m;return e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-4 md:px-0",children:[e.jsxs("div",{children:[e.jsx(b,{}),e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"Уведомления"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o>0&&e.jsxs(y,{variant:"default",className:"rounded-full",children:[o," новый"]}),e.jsx(n,{variant:"outline",size:"sm",onClick:j,disabled:o===0||h,children:"Отметить все как прочитанное"})]})]}),e.jsx(B,{className:"h-[calc(100vh-200px)]",children:e.jsx("div",{className:"space-y-1",children:c.length>0?c.map(s=>e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${s.isRead?"bg-card":"bg-accent"}`,onClick:()=>d(s._id),children:[e.jsxs("div",{className:"flex items-start gap-4",children:[s.relatedData.actorId?e.jsxs(w,{className:"h-10 w-10",children:[e.jsx(M,{src:s.relatedData.actorId.profilePicture,alt:s.relatedData.actorId.name}),e.jsx(R,{className:"bg-black text-white",children:s.relatedData.actorId.name.charAt(0)})]}):e.jsx("div",{className:"h-10 w-10 flex items-center justify-center rounded-full bg-primary/10",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[e.jsx("path",{d:"M2 20h.01"}),e.jsx("path",{d:"M7 20v-4"}),e.jsx("path",{d:"M12 20v-8"}),e.jsx("path",{d:"M17 20V8"}),e.jsx("path",{d:"M22 4v16"})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-medium",children:s.title}),e.jsx("span",{className:"text-xs text-muted-foreground",children:C(s.createdAt,{addSuffix:!0})})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.message})]})]}),!s.isRead&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>f(s._id),disabled:u,children:"Отметить как прочитанное"})})]},s._id)):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Нет уведомлений"})})})})]})},te=g(D);export{te as default,re as meta};
